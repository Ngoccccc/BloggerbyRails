#!/bin/bash
set -e

echo "ğŸ³ Setting up Rails application with Docker..."

# Build and start containers
echo "ğŸ“¦ Building Docker containers..."
docker-compose build

echo "ğŸš€ Starting containers..."
docker-compose up -d

# Wait for MySQL to be ready
echo "â³ Waiting for MySQL to be ready..."
sleep 10

# Setup database
echo "ğŸ—„ï¸ Setting up database..."
docker-compose exec web bundle exec rails db:create
docker-compose exec web bundle exec rails db:migrate

echo "âœ… Setup complete!"
echo "ğŸŒ Your Rails app is running at: http://localhost:3000"
echo "ğŸ—„ï¸ MySQL is running at: localhost:3306"
echo ""
echo "ğŸ“‹ Useful commands:"
echo "  docker-compose logs web     # View Rails logs"
echo "  docker-compose logs db      # View MySQL logs"
echo "  docker-compose exec web bash # Access Rails container"
echo "  docker-compose down         # Stop all containers" 